<div [hidden]="hidden" class="request-list-cls">
  <app-blockable-div #pDataTableDiv >
  <div *ngIf="!isTablet">
  <p-dataTable #dt id="dt" [value]="requestResult" 
  [scrollable]="scrollable" [scrollHeight]="scrollheight" 
  [alwaysShowPaginator]="false" [rows]="rowsPerPage" [paginator]="paginator" [totalRecords]="totalRecords"
  selectionMode="single" (onRowSelect)="onRowSelect($event,dt)"  
  [rowHover]="true" [responsive]="true" [resizableColumns]="true"
  dataKey="protocolname" tableStyleClass="request-list-style-cls-full" >
    <p-header>
      <span>Request</span>
      <div [hidden]="!isSelected" style="position:absolute; top:0.2em; right:0.5em">
        <button pButton type="button" (click)="onButtonClick()" class="ui-button-primary" icon="fa-backward" label="Back"></button>
      </div>
    </p-header>
    <!--<p-footer>Footer</p-footer>-->
    <p-column field="status" [header]="header.status" sortable="true" [style]="{'width':'5%'}">
      <ng-template let-col let-row="rowData" let-rowIndex="rowIndex" pTemplate="body">
        <div #approveDiv  style="text-align:center" *ngIf="row[col.field]=='APPROVAL_REQUESTED'; then approveButton else notSureButton"></div>
        <!--<span [pTooltip]="row[col.field]" [appendTo]="approveDiv"> {{row[col.field]}} </span>-->
        <ng-template #approveButton>
          <div style="text-align:center">
            <span [pTooltip]="row[col.field]" positionStyle="fixed">
              <i class="fa fa-exclamation fa-lg" aria-hidden="true" style="color:#ffb300"></i>
            </span>
          </div>
        </ng-template>
        <ng-template #notSureButton>
           <div style="text-align:center">
             <span [pTooltip]="row[col.field]" positionStyle="fixed"> 
             <span class="fa-stack" style="text-align:center"> 
              <i class="fa fa-trash fa-stack-2x"></i>
              <i class="fa fa-exclamation fa-stack-1x" style="color:#ffb300"></i>
             </span>
             </span> 
           </div> 
        </ng-template>
      </ng-template>

    </p-column>
    <p-column field="type" [header]="header.type" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
      <ng-template pTemplate="header">
        <span ppTooltip="patienttype" escape="false" positionStyle="fixed"> {{header.type}} </span>
      </ng-template>
    </p-column>
    <p-column field="patienttype" [header]="header.patienttype" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
    <p-column field="protocolname" [header]="header.protocolname" [style]="{'width':'20%'}" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
    <p-column field="version" [header]="header.version" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
    <p-column field="lastupddt" [header]="header.lastupddt" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
    <p-column field="displaymachinename" [header]="header.displaymachinename" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
    <p-column field="applicant" [header]="header.applicant" sortable="true">
      <ng-template pTemplate="body" let-col let-row="rowData">
        <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
      </ng-template>
    </p-column>
  </p-dataTable>
</div>
<div *ngIf="isTablet">
    <p-dataTable #dt id="dt" [value]="requestResult" 
    [scrollable]="scrollable" [scrollHeight]="scrollheight" 
    [alwaysShowPaginator]="false" [rows]="rowsPerPage" [paginator]="paginator" [totalRecords]="totalRecords"
    selectionMode="single" (onRowSelect)="onRowSelect($event,dt)"  
    [rowHover]="true" [resizableColumns]="true"
    dataKey="protocolname" expandableRows="true" tableStyleClass="request-list-style-cls-full" >
    <p-column expander="true" styleClass="col-icon" [style]="{'width':'5%'}"></p-column>
    <p-column field="status" [header]="header.status" sortable="true" [style]="{'width':'5%'}">
        <ng-template let-col let-row="rowData" let-rowIndex="rowIndex" pTemplate="body">
          <div #approveDiv  style="text-align:center" *ngIf="row[col.field]=='APPROVAL_REQUESTED'; then approveButton else notSureButton"></div>
          <!--<span [pTooltip]="row[col.field]" [appendTo]="approveDiv"> {{row[col.field]}} </span>-->
          <ng-template #approveButton>
            <div style="text-align:center">
              <span [pTooltip]="row[col.field]" positionStyle="fixed">
                <i class="fa fa-exclamation fa-lg" aria-hidden="true" style="color:#ffb300"></i>
              </span>
            </div>
          </ng-template>
          <ng-template #notSureButton>
             <div style="text-align:center">
               <span [pTooltip]="row[col.field]" positionStyle="fixed"> 
               <span class="fa-stack" style="text-align:center"> 
                <i class="fa fa-trash fa-stack-2x"></i>
                <i class="fa fa-exclamation fa-stack-1x" style="color:#ffb300"></i>
               </span>
               </span> 
             </div> 
          </ng-template>
        </ng-template>
  
      </p-column>
      <p-column field="type" [header]="header.type" sortable="true">
        <ng-template pTemplate="body" let-col let-row="rowData">
          <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
        </ng-template>
        <ng-template pTemplate="header">
          <span ppTooltip="patienttype" escape="false" positionStyle="fixed"> {{header.type}} </span>
        </ng-template>
      </p-column>
      <p-column field="patienttype" [header]="header.patienttype" sortable="true">
        <ng-template pTemplate="body" let-col let-row="rowData">
          <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
        </ng-template>
      </p-column>
      <p-column field="protocolname" [header]="header.protocolname" [style]="{'width':'20%'}" sortable="true">
        <ng-template pTemplate="body" let-col let-row="rowData">
          <span [pTooltip]="row[col.field]" positionStyle="fixed"> {{row[col.field]}} </span>
        </ng-template>
      </p-column>
      <ng-template let-row pTemplate="rowexpansion">
          <div class="ui-grid ui-grid-responsive ui-fluid" style="padding:20px">
              <div class="ui-grid-row">
                  <div class="ui-grid-col-3" style="text-align:center">
                  </div>
                  <div class="ui-grid-col-9">
                      <div class="ui-grid ui-grid-responsive ui-grid-pad">
                          <div class="ui-grid-row">
                              <div class="ui-grid-col-4 label">Version: </div>
                              <div class="ui-grid-col-8">{{row.version}}</div>
                          </div>
                          <div class="ui-grid-row">
                              <div class="ui-grid-col-4 label">Last Update: </div>
                              <div class="ui-grid-col-8">{{row.lastupddt}}</div>
                          </div>
                          <div class="ui-grid-row">
                              <div class="ui-grid-col-4 label">Machinename: </div>
                              <div class="ui-grid-col-8">{{row.displaymachinename}}</div>
                          </div>
                          <div class="ui-grid-row">
                              <div class="ui-grid-col-4 label">Applicant: </div>
                              <div class="ui-grid-col-8">{{row.applicant}}</div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </ng-template>
      </p-dataTable>
</div>
  </app-blockable-div>
<!-- <div [hidden]="isSelected"> -->
  <app-compare-panel *ngIf="isSelected" [blockState]="blockState" [compareList]="compareList" [selectedProtocol]="selectedProtocol" [hiddenthirdColumn]="hiddenthirdColumn"></app-compare-panel>
<!-- </div> -->
</div>
<ng-template #approveButton>
  <div style="text-align:center">
      <i class="fa fa-exclamation fa-lg" aria-hidden="true" style="color:#ffb300"></i>
  </div>
</ng-template>
<ng-template #notSureButton>
    <div style="text-align:center"> 
      <span class="fa-stack" style="text-align:center"> 
      <i class="fa fa-trash fa-stack-2x"></i>
      <i class="fa fa-exclamation fa-stack-1x" style="color:#ffb300"></i>
    </span> 
    </div> 
</ng-template>
<p-blockUI [target]="pDataTableDiv" [blocked]="blockDtState">
    <i class="fa fa-circle-o-notch fa-spin fa-2x" style="position:absolute;top:25%;left:50%;color:#1b1d1f;z-index:2"></i>
</p-blockUI>
<router-outlet></router-outlet> 
